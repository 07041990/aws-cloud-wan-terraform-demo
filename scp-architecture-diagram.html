<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS Organizations SCPs for PCI Compliance - Architecture Diagram</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Amazon Ember', 'Helvetica Neue', Arial, sans-serif;
            background: #232f3e;
            padding: 20px;
            color: #232f3e;
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 40px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #ff9900;
        }
        
        .header h1 {
            color: #232f3e;
            font-size: 2.2em;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header .subtitle {
            color: #545b64;
            font-size: 1.1em;
        }
        
        .aws-logo {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .aws-logo-text {
            font-size: 2.5em;
            font-weight: bold;
            color: #ff9900;
            letter-spacing: 2px;
        }
        
        /* Organization Layer */
        .org-layer {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .org-title {
            color: white;
            font-size: 1.8em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .org-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
        }
        
        /* PCI OU Box */
        .pci-ou {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .pci-ou-title {
            font-size: 1.4em;
            font-weight: bold;
            color: #d13212;
            margin-bottom: 15px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid #d13212;
        }
        
        .ou-accounts {
            margin-top: 15px;
        }
        
        .account-item {
            background: #f8f9fa;
            padding: 12px;
            margin: 8px 0;
            border-radius: 6px;
            border-left: 4px solid #ff9900;
        }
        
        .account-name {
            font-weight: bold;
            color: #232f3e;
        }
        
        .account-id {
            font-size: 0.85em;
            color: #545b64;
            font-family: 'Courier New', monospace;
        }
        
        /* SCPs Grid */
        .scps-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .scp-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 5px solid;
            transition: transform 0.2s;
        }
        
        .scp-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .scp-card.region { border-left-color: #3498db; }
        .scp-card.service { border-left-color: #e74c3c; }
        .scp-card.s3 { border-left-color: #f39c12; }
        .scp-card.network { border-left-color: #9b59b6; }
        .scp-card.encryption { border-left-color: #1abc9c; }
        .scp-card.logs { border-left-color: #34495e; }
        .scp-card.instance { border-left-color: #16a085; }
        .scp-card.security { border-left-color: #c0392b; }
        .scp-card.mfa { border-left-color: #2980b9; }
        .scp-card.root { border-left-color: #8e44ad; }
        
        .scp-number {
            background: #232f3e;
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9em;
            margin-right: 10px;
        }
        
        .scp-title {
            font-weight: bold;
            color: #232f3e;
            font-size: 1em;
            margin-bottom: 8px;
        }
        
        .scp-desc {
            font-size: 0.85em;
            color: #545b64;
            line-height: 1.4;
        }
        
        /* Enforcement Arrow */
        .enforcement-arrow {
            text-align: center;
            padding: 20px 0;
            font-size: 2.5em;
            color: #ff9900;
            font-weight: bold;
        }
        
        /* Infrastructure Layer */
        .infra-layer {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
        }
        
        .infra-title {
            font-size: 1.6em;
            font-weight: bold;
            color: #232f3e;
            text-align: center;
            margin-bottom: 25px;
        }
        
        .infra-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
        }
        
        .infra-item {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 2px solid #dee2e6;
        }
        
        .infra-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .infra-name {
            font-weight: bold;
            color: #232f3e;
            margin-bottom: 5px;
        }
        
        .infra-status {
            font-size: 0.85em;
            color: #28a745;
            font-weight: 600;
        }
        
        /* Compliance Matrix */
        .compliance-matrix {
            background: #fff3cd;
            border-left: 6px solid #ffc107;
            border-radius: 10px;
            padding: 25px;
            margin: 30px 0;
        }
        
        .compliance-title {
            font-size: 1.4em;
            font-weight: bold;
            color: #856404;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .compliance-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .compliance-item {
            background: white;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #28a745;
        }
        
        .compliance-item:before {
            content: "‚úì";
            color: #28a745;
            font-weight: bold;
            font-size: 1.3em;
            margin-right: 10px;
        }
        
        .compliance-req {
            font-weight: bold;
            color: #232f3e;
            margin-bottom: 5px;
        }
        
        .compliance-scp {
            font-size: 0.85em;
            color: #545b64;
        }
        
        /* CloudTrail Logging */
        .cloudtrail-section {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }
        
        .cloudtrail-title {
            font-size: 1.5em;
            font-weight: bold;
            color: #1b5e20;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .cloudtrail-content {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .log-example {
            background: #f5f5f5;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            border-radius: 4px;
        }
        
        /* Legend */
        .legend {
            background: #f8f9fa;
            border: 2px solid #879596;
            border-radius: 8px;
            padding: 25px;
            margin-top: 40px;
        }
        
        .legend-title {
            font-weight: bold;
            font-size: 1.3em;
            color: #232f3e;
            margin-bottom: 20px;
            border-bottom: 2px solid #ff9900;
            padding-bottom: 10px;
        }
        
        .legend-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .legend-color {
            width: 40px;
            height: 40px;
            border-radius: 6px;
            flex-shrink: 0;
            border: 2px solid #879596;
        }
        
        .legend-text {
            font-size: 0.95em;
            color: #232f3e;
        }
        
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .container {
                box-shadow: none;
            }
        }
        
        @media (max-width: 1200px) {
            .org-content {
                grid-template-columns: 1fr;
            }
            
            .scps-grid {
                grid-template-columns: 1fr;
            }
            
            .infra-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .compliance-grid {
                grid-template-columns: 1fr;
            }
            
            .legend-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="aws-logo">
            <div class="aws-logo-text">AWS</div>
        </div>
        
        <div class="header">
            <h1>AWS Organizations Service Control Policies</h1>
            <p class="subtitle">PCI-DSS Compliance Enforcement Architecture</p>
        </div>
        
        <!-- AWS Organization Layer -->
        <div class="org-layer">
            <div class="org-title">‚òÅÔ∏è AWS Organization - Policy Enforcement Layer</div>
            
            <div class="org-content">
                <!-- PCI OU -->
                <div class="pci-ou">
                    <div class="pci-ou-title">üîí PCI-Isolated-Workloads OU</div>
                    <p style="text-align: center; color: #545b64; font-size: 0.9em; margin-bottom: 15px;">
                        Organizational Unit with 10 SCPs Attached
                    </p>
                    
                    <div class="ou-accounts">
                        <div class="account-item">
                            <div class="account-name">Production Account</div>
                            <div class="account-id">222222222222</div>
                        </div>
                        <div class="account-item">
                            <div class="account-name">Non-Production Account</div>
                            <div class="account-id">333333333333</div>
                        </div>
                        <div class="account-item">
                            <div class="account-name">Shared Services Account</div>
                            <div class="account-id">444444444444</div>
                        </div>
                    </div>
                </div>
                
                <!-- SCPs Grid -->
                <div class="scps-grid">
                    <div class="scp-card region">
                        <div class="scp-title">
                            <span class="scp-number">1</span>
                            Region Restriction
                        </div>
                        <div class="scp-desc">
                            Only allows approved regions (us-east-1, us-west-2, eu-west-1). Blocks all actions in unapproved regions.
                        </div>
                    </div>
                    
                    <div class="scp-card service">
                        <div class="scp-title">
                            <span class="scp-number">2</span>
                            Service Disallowance
                        </div>
                        <div class="scp-desc">
                            Blocks 13+ non-approved services (Lightsail, GameLift, WorkSpaces, etc.). Even root cannot access.
                        </div>
                    </div>
                    
                    <div class="scp-card s3">
                        <div class="scp-title">
                            <span class="scp-number">3</span>
                            Public S3 Prevention
                        </div>
                        <div class="scp-desc">
                            Blocks public S3 buckets, public ACLs, and public bucket policies. Requires encryption (AES256/KMS).
                        </div>
                    </div>
                    
                    <div class="scp-card network">
                        <div class="scp-title">
                            <span class="scp-number">4</span>
                            Public Networking Block
                        </div>
                        <div class="scp-desc">
                            Prevents IGW, NAT Gateway, EIP creation, public subnets, and open security groups (0.0.0.0/0).
                        </div>
                    </div>
                    
                    <div class="scp-card encryption">
                        <div class="scp-title">
                            <span class="scp-number">5</span>
                            Encryption Enforcement
                        </div>
                        <div class="scp-desc">
                            Requires encryption for all storage: EBS, RDS, S3, EFS, DynamoDB. Unencrypted resources blocked.
                        </div>
                    </div>
                    
                    <div class="scp-card logs">
                        <div class="scp-title">
                            <span class="scp-number">6</span>
                            Mandatory Flow Logs
                        </div>
                        <div class="scp-desc">
                            VPC Flow Logs and TGW Flow Logs cannot be deleted or disabled. CloudWatch log groups protected.
                        </div>
                    </div>
                    
                    <div class="scp-card instance">
                        <div class="scp-title">
                            <span class="scp-number">7</span>
                            Instance Type Allowlist
                        </div>
                        <div class="scp-desc">
                            Only approved EC2 instance types allowed (t3.medium, m5.large, c5.large, r5.large, etc.).
                        </div>
                    </div>
                    
                    <div class="scp-card security">
                        <div class="scp-title">
                            <span class="scp-number">8</span>
                            Security Control Protection
                        </div>
                        <div class="scp-desc">
                            Prevents disabling CloudTrail, AWS Config, GuardDuty, and Security Hub. Ensures continuous monitoring.
                        </div>
                    </div>
                    
                    <div class="scp-card mfa">
                        <div class="scp-title">
                            <span class="scp-number">9</span>
                            MFA Requirement
                        </div>
                        <div class="scp-desc">
                            Requires MFA for all sensitive operations. Blocks actions without MFA present (except MFA setup).
                        </div>
                    </div>
                    
                    <div class="scp-card root">
                        <div class="scp-title">
                            <span class="scp-number">10</span>
                            Root User Restriction
                        </div>
                        <div class="scp-desc">
                            Blocks root user from most actions. Only allows MFA setup and password changes. Forces IAM usage.
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="enforcement-arrow">‚¨á ENFORCED ON ‚¨á</div>
        
        <!-- Infrastructure Layer -->
        <div class="infra-layer">
            <div class="infra-title">Protected Infrastructure Resources</div>
            
            <div class="infra-grid">
                <div class="infra-item">
                    <div class="infra-icon">üåê</div>
                    <div class="infra-name">VPCs</div>
                    <div class="infra-status">‚úì Protected</div>
                </div>
                
                <div class="infra-item">
                    <div class="infra-icon">üíæ</div>
                    <div class="infra-name">S3 Buckets</div>
                    <div class="infra-status">‚úì Protected</div>
                </div>
                
                <div class="infra-item">
                    <div class="infra-icon">üñ•Ô∏è</div>
                    <div class="infra-name">EC2 Instances</div>
                    <div class="infra-status">‚úì Protected</div>
                </div>
                
                <div class="infra-item">
                    <div class="infra-icon">üóÑÔ∏è</div>
                    <div class="infra-name">RDS Databases</div>
                    <div class="infra-status">‚úì Protected</div>
                </div>
                
                <div class="infra-item">
                    <div class="infra-icon">üîê</div>
                    <div class="infra-name">Security Groups</div>
                    <div class="infra-status">‚úì Protected</div>
                </div>
                
                <div class="infra-item">
                    <div class="infra-icon">üåç</div>
                    <div class="infra-name">IGW/NAT</div>
                    <div class="infra-status">‚úì Protected</div>
                </div>
                
                <div class="infra-item">
                    <div class="infra-icon">üìä</div>
                    <div class="infra-name">CloudTrail</div>
                    <div class="infra-status">‚úì Protected</div>
                </div>
                
                <div class="infra-item">
                    <div class="infra-icon">üîç</div>
                    <div class="infra-name">Flow Logs</div>
                    <div class="infra-status">‚úì Protected</div>
                </div>
            </div>
        </div>
        
        <!-- PCI Compliance Matrix -->
        <div class="compliance-matrix">
            <div class="compliance-title">‚úÖ PCI-DSS Compliance Requirements Met</div>
            
            <div class="compliance-grid">
                <div class="compliance-item">
                    <div class="compliance-req">Disallowed services fail for root</div>
                    <div class="compliance-scp">Enforced by SCP #2 - Service Disallowance</div>
                </div>
                
                <div class="compliance-item">
                    <div class="compliance-req">No public S3 buckets</div>
                    <div class="compliance-scp">Enforced by SCP #3 - Public S3 Prevention</div>
                </div>
                
                <div class="compliance-item">
                    <div class="compliance-req">No open SGs to 0.0.0.0/0</div>
                    <div class="compliance-scp">Enforced by SCP #4 - Public Networking Block</div>
                </div>
                
                <div class="compliance-item">
                    <div class="compliance-req">Only approved regions</div>
                    <div class="compliance-scp">Enforced by SCP #1 - Region Restriction</div>
                </div>
                
                <div class="compliance-item">
                    <div class="compliance-req">No public networking (IGW, NAT, EIP)</div>
                    <div class="compliance-scp">Enforced by SCP #4 - Public Networking Block</div>
                </div>
                
                <div class="compliance-item">
                    <div class="compliance-req">Mandatory VPC Flow Logs</div>
                    <div class="compliance-scp">Enforced by SCP #6 - Mandatory Flow Logs</div>
                </div>
                
                <div class="compliance-item">
                    <div class="compliance-req">All storage encrypted</div>
                    <div class="compliance-scp">Enforced by SCP #5 - Encryption Enforcement</div>
                </div>
                
                <div class="compliance-item">
                    <div class="compliance-req">S3 cannot be public</div>
                    <div class="compliance-scp">Enforced by SCP #3 - Public S3 Prevention</div>
                </div>
                
                <div class="compliance-item">
                    <div class="compliance-req">Only approved instance types</div>
                    <div class="compliance-scp">Enforced by SCP #7 - Instance Type Allowlist</div>
                </div>
                
                <div class="compliance-item">
                    <div class="compliance-req">SCP violations in CloudTrail</div>
                    <div class="compliance-scp">All SCPs - Automatic logging</div>
                </div>
            </div>
        </div>
        
        <!-- CloudTrail Logging -->
        <div class="cloudtrail-section">
            <div class="cloudtrail-title">üìä Automatic CloudTrail Logging</div>
            
            <div class="cloudtrail-content">
                <p style="margin-bottom: 15px; color: #232f3e;">
                    <strong>All SCP violations are automatically logged in AWS CloudTrail</strong> with detailed information about:
                </p>
                
                <div class="log-example">
                    <strong>Example SCP Deny Event:</strong><br><br>
                    {<br>
                    &nbsp;&nbsp;"eventName": "CreateInternetGateway",<br>
                    &nbsp;&nbsp;"errorCode": "AccessDenied",<br>
                    &nbsp;&nbsp;"errorMessage": "You are not authorized to perform this operation",<br>
                    &nbsp;&nbsp;"userIdentity": {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;"principalId": "AIDAI...",<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;"arn": "arn:aws:iam::222222222222:user/developer"<br>
                    &nbsp;&nbsp;},<br>
                    &nbsp;&nbsp;"requestParameters": {...},<br>
                    &nbsp;&nbsp;"responseElements": null<br>
                    }
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 20px;">
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; text-align: center;">
                        <div style="font-size: 2em; margin-bottom: 5px;">üë§</div>
                        <div style="font-weight: bold; color: #232f3e;">Who</div>
                        <div style="font-size: 0.85em; color: #545b64;">User/Role identity</div>
                    </div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; text-align: center;">
                        <div style="font-size: 2em; margin-bottom: 5px;">üéØ</div>
                        <div style="font-weight: bold; color: #232f3e;">What</div>
                        <div style="font-size: 0.85em; color: #545b64;">Action attempted</div>
                    </div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; text-align: center;">
                        <div style="font-size: 2em; margin-bottom: 5px;">‚è∞</div>
                        <div style="font-weight: bold; color: #232f3e;">When</div>
                        <div style="font-size: 0.85em; color: #545b64;">Timestamp</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Legend -->
        <div class="legend">
            <div class="legend-title">üìã Architecture Legend</div>
            <div class="legend-grid">
                <div class="legend-item">
                    <div class="legend-color" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
                    <div class="legend-text">AWS Organization Layer</div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: white; border-color: #d13212;"></div>
                    <div class="legend-text">PCI Organizational Unit</div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: #3498db;"></div>
                    <div class="legend-text">Region Restriction SCP</div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: #e74c3c;"></div>
                    <div class="legend-text">Service Disallowance SCP</div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: #f39c12;"></div>
                    <div class="legend-text">Public S3 Prevention SCP</div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: #9b59b6;"></div>
                    <div class="legend-text">Public Networking Block SCP</div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: #1abc9c;"></div>
                    <div class="legend-text">Encryption Enforcement SCP</div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: #34495e;"></div>
                    <div class="legend-text">Mandatory Flow Logs SCP</div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: #16a085;"></div>
                    <div class="legend-text">Instance Type Allowlist SCP</div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: #c0392b;"></div>
                    <div class="legend-text">Security Control Protection SCP</div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: #2980b9;"></div>
                    <div class="legend-text">MFA Requirement SCP</div>
                </div>
                
                <div class="legend-item">
                    <div class="legend-color" style="background: #8e44ad;"></div>
                    <div class="legend-text">Root User Restriction SCP</div>
                </div>
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 2px solid #eaeded; color: #879596;">
            <p><strong>AWS Organizations Service Control Policies for PCI-DSS Compliance</strong></p>
            <p style="margin-top: 10px;">10 SCPs | Organization-Level Enforcement | Cannot Be Bypassed | CloudTrail Logged</p>
            <p style="margin-top: 10px; font-size: 0.9em;">File: scp.tf | Optional Component | Terraform Managed</p>
        </div>
    </div>
</body>
</html>
